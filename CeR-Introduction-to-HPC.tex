\documentclass{beamer}
\usepackage[english]{layout}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath, soul, color, multicol, type1cm, verbatim, latexsym, dsfont, float, listings}
\usepackage[official]{eurosym}
\usepackage{beamerthemesplit}
\usepackage{hyperref}
\usetheme{Frankfurt}
\usecolortheme{lily}
%\usefonttheme{structuresmallcapsserif}
\usefonttheme{professionalfonts}
\setbeamercovered{transparent}

%NeSI Colors <---------------------------------------------------------------------------------------
\usecolortheme[RGB={47, 68, 71}]{structure} 
\definecolor{nesidark}{HTML}{2F4447}
\definecolor{nesilight}{HTML}{CED9DF}
\definecolor{nesigrey}{gray}{0.7}
\definecolor{nesilightgrey}{gray}{0.98}
\definecolor{nesidarkgrey}{gray}{0.3}
\definecolor{nesiblue}{HTML}{2B9FC2}
\setbeamercolor{block title}{fg=black,bg=nesigrey}
\setbeamercolor{block body}{bg=nesilightgrey,fg=nesidarkgrey}
\setbeamercolor{block body alerted}{bg=white,fg=black}
\setbeamercolor{alerted text}{bg=white,fg=black}

%\setbeameroption{show notes}

\setbeamerfont{title}{size=\huge}
\frenchspacing
\hyphenation{NeSI}

\newenvironment{topcolumns}{\begin{columns}[t]}{\end{columns}}
\newcommand\BackgroundPicture[1]{%
\setbeamertemplate{background}{%
\parbox[c][\paperheight]{\paperwidth}{%
\vfill \hfill \includegraphics[height=0.9\paperheight]{#1}
\hfill \vfill
}}}

\setbeamertemplate{blocks}[default]%[shadow=false]
\useinnertheme{circles}
\setbeamertemplate{title page}[default][center,rounded=false,shadow=false]
%\setbeamertemplate{title page}[default][center, wd=60mm, colsep=-4bp,rounded=true]

% Fancy Footer Content    <-----------------------------------------------------------------------------
%\setbeamertemplate{footline}{
%   \unilogo
%   \dsglogo
%   \begin{beamercolorbox}[ht=4ex,leftskip=1.4cm,rightskip=.3cm]{author in head/foot}
%    \usebeamercolor{nesiblue}
%    \hrule
%    \vspace{0.1cm}
%    \insertdate \hfill \inserttitle \newline
%    \insertshortauthor \ - \insertshortinstitute \hfill \insertframenumber
%   \end{beamercolorbox}
%   \vspace*{0.1cm}
%} 
% Reference http://joerglenhard.wordpress.com/2011/08/04/beamer-customization-ii-footline-with-multiple-lines/
% http://joerglenhard.wordpress.com/tag/beamer/
% https://github.com/lenhard/ub-beamer


\title{Introduction to HPC Workshop}
%\subtitle{Computational Science team}
\author{Center for eResearch \\(eresearch@nesi.org.nz)}
\date{}


\begin{document}

{
%\setbeamertemplate{background canvas}{\includegraphics[height=0.99\paperheight]{NeSI_img/Slide00.png}} 
\begin{frame}[plain]
\vspace{1cm}
\titlepage
\end{frame}
}


%\BackgroundPicture{NeSI_img/SlideXX.png}
\begin{frame}
\frametitle{Outline}
\begin{multicols}{2}
   \tableofcontents
 \end{multicols}
 \end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{About Us}
\subsection{About CER and NeSI}
\frame[t]
{
  \frametitle{About Us}
     \begin{block}{CER: Center for eResearch}
   \begin{itemize}%[<+-| alert@+>]
	\item Part of the University of Auckland
	\item User support and system maintenance 
   \end{itemize}
  \end{block}
   \begin{block}{NeSI : New Zealand eScience Infrastructure}
   \begin{itemize}%[<+-| alert@+>]
	\item \textbf{NeSI} provides
	\begin{itemize}
		\item high performance computing
		\item a national data storage and sharing service 
		\item expert support, including engineering
		\item single-sign on across the NZ research sector
	\end{itemize}
   \end{itemize}
  \end{block}
}

\frame[t]
{
  \frametitle{About Us}
\begin{center}
\vspace*{1cm}
 \includegraphics[width=225pt]{NeSI_img/nesi_logo.jpg}\\
 \includegraphics[width=50pt]{NeSI_img/logo-u-of-a.jpg}
 \includegraphics[width=50pt]{NeSI_img/logo-u-of-c.jpg}
 \includegraphics[width=50pt]{NeSI_img/logo-niwa.jpg}
 \includegraphics[width=50pt]{NeSI_img/logo-ministry-of-si.jpg} 
 \includegraphics[width=50pt]{NeSI_img/logo-manaaki-whenua.jpg}
 \includegraphics[width=50pt]{NeSI_img/logo-u-of-o.jpg}
\end{center}
}

\subsection{The CS Team}
\frame[t]
{
  \frametitle{About Us}
      \begin{block}{Computational Science Team}
   \begin{itemize}%[<+-| alert@+>]
	\item We support researchers to get the most out of our platforms and services.
	\item The CS Team has a lot of experience in HPC that spans many science domains.
	\item Collaboratively enhance the performance of research software codes.
   \begin{itemize}
   	\item Troubleshoot memory and other or I/O bottlenecks.
	\item Connect researchers and scientific software experts.
	\item The team is available to support researchers across any research institution in New Zealand.
   \end{itemize}
   \end{itemize}
  \end{block}
}

\frame[t]
{
  \frametitle{About Us}
      \begin{block}{Support}
   \begin{itemize}%[<+-| alert@+>]
	\item Email \url{eresearch@nesi.org.nz}
	\item Creates a support ‘ticket’ where we can track the history of your request
	\item You can also arrange to meet us to discuss any issues
   \end{itemize}
   \begin{center}
   \includegraphics[width=100pt]{NeSI_img/pingu-friend.jpg}
   \end{center}
  \end{block}
}




\section{Key Concepts}
\subsection{What is a Cluster}
\frame[t]
{
  \frametitle{Key Concepts}
  \begin{columns}[onlytextwidth]
   
  \begin{column}{0.6\textwidth}
  
	  \begin{block}{What is a cluster}
      \begin{itemize}%[<+-| alert@+>]
	    \item A cluster is a network of computers, sometimes called nodes or hosts.
	    \item Each computer has several processors.
	    \item Each processor has several cores.
	    \item A core does the computing.
	    \item If your application uses more than one core, it can run faster on our cluster.
      \end{itemize}
      \end{block}
      \end{column}
      \begin{column}{0.4\textwidth}
      \includegraphics[width=140pt]{NeSI_img/node_view.png}
      \end{column}
   \end{columns}
}

% \note{Can the content of the node be changed by the image of the cpu's and the shared memory of a couple of slides further?}
% \frame[t]
% {
%   \frametitle{Key Concepts}
%    \begin{block}{HPC node overview}
%    \begin{center}
%  \includegraphics[width=270pt]{NeSI_img/node_view.png}
%    \end{center}
%   \end{block}
%   
% \begin{center}
% \end{center}
% }

\subsection{Parallel Programming}
\frame[t]
{
  \frametitle{Key Concepts}
      \begin{block}{Parallel Programming}
   \begin{itemize}%[<+-| alert@+>]
	\item There are several ways to make a program use more cores and hence run faster.
	\item Many scientific software applications will be able to use multiple cores in some way. But this is often done explicitly by the user, not automagically.
	\item We can help you improve the performance of your code or make better use of your application.
   \end{itemize}
  \end{block}
}

\subsection{Shared Memory}
\frame[t]
{
  \frametitle{Key Concepts}
      \begin{block}{Shared Memory}
   \begin{itemize}%[<+-| alert@+>]
	\item Symmetric multiprocessing (SMP) : two or more identical processors are connected to a single shared main memory.
	\item This shared memory may be simultaneously accessed by single program using multiple threads.
	\item There are different frameworks for utilizing SMP capabilities.
   \end{itemize}
\begin{center}
 \includegraphics[width=90pt]{NeSI_img/shared_mem.png}
\end{center}
  \end{block}
}

%\frame[t]
%{
%  \frametitle{Key Concepts}
%      \begin{block}{Shared Memory : OpenMP}
%       \begin{itemize}%[<+-| alert@+>]
%	\item A master thread forks a specified number of slave threads and a task is divided among them. 
%	\item After the execution of the parallelized code, the threads join back into the master thread.
%	%\item Both task parallelism and data parallelism can be achieved using OpenMP in this way.
%   \end{itemize}
%\begin{center}
% \includegraphics[width=250pt]{NeSI_img/800px-Fork_join.png}
%\end{center}
%  \end{block}
%}


\subsection{Distributed Memory}

\frame[t]
{
  \frametitle{Key Concepts}
      \begin{block}{Distributed Memory}
   \begin{itemize}%[<+-| alert@+>]
	\item Multiple-processor computer system in which each process has its own private memory. 
	\item Computational tasks can only operate on local data.
	\item If remote data is required, the computational task must communicate with one or more remote processors.
	\item The most popular parallel programming paradigm is MPI (Message Passing Interface).
   \end{itemize}
\begin{center}
 %\includegraphics[width=120pt]{NeSI_img/parallel_paradigm/distributed_mem.png}
 \includegraphics[width=150pt]{NeSI_img/hybrid_mem.png}
\end{center}
  \end{block}
}


%\frame[t]
%{
%  \frametitle{Key Concepts}
%      \begin{block}{Hybrid Case : MPI+OpenMP}
%   \begin{itemize}%[<+-| alert@+>]
%	\item The application opens several MPI instances (one or more in each node) 
%	\item Each MPI instance runs OpenMP threads
%	\item Typically one MPI instance per Socket and one OpenMP Thread per core.
%   \end{itemize}
%\begin{center}
% \includegraphics[width=170pt]{NeSI_img/hybrid_mem.png}
%\end{center}
%  \end{block}
%}

\section{Our Facilities}
\subsection{}
\frame[t]
{
  \frametitle{Our Facilities}
      \begin{block}{NeSI Facilities}
   \begin{itemize}%[<+-| alert@+>]
	\item NeSI provides several kind of HPC architectures and solutions to cater for various needs.
     \begin{itemize}
     	\item Bluegene/P
	    \item Power6 and Power7
   		\item Intel Westmere
		\item Intel SandyBridge
		\item Kepler and Fermi GPU servers
		\item Intel Xeon Phi Co-Processor
   \end{itemize}
	\item Supported applications can run on across several NeSI architectures.% but for some of them there are more suitable architecture.
	\item We can install and study the scalability in all the NeSI resources and find the most suitable environment for your case.
	\item See NeSI website for facility specs and application details.
   \end{itemize}
  \end{block}
}
\frame[t]
{
  \frametitle{Our Facilities}
      \begin{block}{NeSI CeR Supercomputing Center}
   \begin{itemize}%[<+-| alert@+>]
	\item Funded by the \textbf{University of Auckland}, \textbf{Landcare Research} and the \textbf{University of Otago} with co-investment from the NZ Government through \textbf{NeSI}.
	\item Currently have around 5,000 Intel CPU cores across about 300 hosts.
	\item About 3.5 TB of memory and 80 TFLOPS (distributed).
	\item Shared storage of 400 TB with a 40 Gbit/s Infiniband network.
	\item Linux RHEL 6.3
   \end{itemize}
  \end{block}
}

\frame[t]
{
  \frametitle{Our Facilities}
      \begin{block}{NeSI Pan Cluster}
      \begin{center}
       \begin{small}
      \begin{tabular}{|c|c|c|c|}
      \hline 
      \textbf{Architecture} & \textbf{Westmere} & \textbf{SandyBridge} & \textbf{LargeMem} \\ 
      \hline 
      Model & X5660 & E5-2680 & E7-4870 \\ 
      \hline 
      Clock Speed & 2.8 GHz & 2.7 GHz & 2.4GHz \\ 
      \hline 
      Cache & 12MB & 20MB & 30MB \\ 
      \hline 
      Intel QPI speed & 6.4GT/s & 8 GT/s & 6.4GT/ \\ 
      \hline 
      Cores/socket & 6 & 8 & 10 \\ 
      \hline       
      Cores/node & 12 & 16 & 40 \\ 
      \hline 
      Mem/node & 96GB & 128GB & 512GB \\ 
      \hline 
      GFLOPS/node & 134.4 & 345.6 & 384.0 \\ 
      \hline 
      \# nodes & 76 & 194 & 4 \\ 
      \hline 
      \end{tabular} 
      \end{small}
      \end{center}
  \end{block}
}
\frame[t]
{
  \frametitle{Our Facilities}
      \begin{block}{NeSI Pan Cluster - Co-Processors}
      \begin{center}
       \begin{small}
      \begin{tabular}{|c|c|c|c|}
      \hline 
      \textbf{Architecture} & \textbf{Nvidia Fermi} & \textbf{Nvidia Kepler} & \textbf{Intel Phi} \\ 
      \hline 
      Main CPU                  &  X5660/E5-2680       &  E5-2680                   &  E5-2680 \\
      \hline 
      Model                       &  M2090                     &   K20X                       &  5110P \\ 
      \hline 
      Clock Speed             &  1.3GHz                    &  0.732GHz                      &  1.053GHz\\ 
      \hline 
%      Cache                      & 12MB                        & 12MB                          & 12MB  \\ 
%      \hline  
%      Intel QPI speed        & 6.4GT/s                   & 6.4GT/s                       & 6.4GT/s  \\ 
%      \hline 
      Cores/Dev.             & 512                            & 2688                           & 60 (240) \\ 
      \hline       
      Dev./node              &  2                             &   2                                &  2  \\ 
      \hline 
      Mem/Dev.             & 6GB                          & 6GB                               & 8GB  \\ 
      \hline 
      TFLOPS/Dev         & 1.33                          & 1.17                              & 1.01 \\ 
      \hline 
      \# nodes               & 16                             & 5                                 & 2 \\ 
      \hline 
      \end{tabular} 
      \end{small}
      \end{center}
  \end{block}
}

\section{Using the Cluster}      

\subsection{Suitable Work}
\frame[t]
{
  \frametitle{What to expect}
      \begin{block}{Suitable Work}
   \begin{itemize}%[<+-| alert@+>]
	\item Problems that can be solved with parallel processing.
	\item Problems that consume large amounts of memory.
	\item Problems that render your desktop useless for long periods of time.
   \end{itemize}
  \end{block}
        \begin{block}{Less suited}
   \begin{itemize}%[<+-| alert@+>]
	\item Windows only software $\mapsto$ Aspirational Research Virtual Machine Farm. 
	\item Interactive software, e.g.\ GUI, only available for development. 
   \end{itemize}
  \end{block}
}

\subsection{What to expect}

\frame[t]
{
  \frametitle{What to expect}
      \begin{block}{Suitable Work}
   \begin{itemize}%[<+-| alert@+>]
	\item Some problems are ``embarrassingly parallel'' i.e.\ it is trivial to divide the problem and solve independently.\\e.g. run simulation with 1000 different initial conditions.
	\item Approximately linear speedup.
	\item Other problems have dependencies, they cannot be separated\\e.g. simulate the weather.
	\item Speed up depends what \% of the program runtime can be parallelised.
   \end{itemize}
  \end{block}
}

\subsection{Parallel speedup}

\frame[t]
{
\begin{topcolumns}
\column{0.5\textwidth}
    \begin{block}{Amdahl’s Law}
    \begin{center}
      \includegraphics[width=120pt]{NeSI_img/Amdahl.png}
    \end{center}
    \end{block}
\column{0.5\textwidth}
     \begin{block}{Real Case: more cores $\neq$ more speed}
   \begin{center}
   \includegraphics[width=160pt]{NeSI_img/migrate_scalability.png}
   \end{center}
  \end{block}
  \end{topcolumns}
}

\frame[t]
{
   \begin{block}{Parallel execution time}
   \begin{itemize}%[<+-| alert@+>]
	\item Single core computation time: computation only.
	\item Parallel computation time: computation + communication + waiting.
	\item E.g.
	\begin{itemize}
	\item writing results (to one file) is often a bottleneck.
	\item Small problem on many cores: communication cost will dominate.
	\item Unbalanced load: one core will mainly wait on the other.
	\end{itemize}
	\item Conclusion: Test which number of cores is best suited for your problem. 
   \end{itemize}
  \end{block}

}



\subsection{General overview}
\frame[t]
{
  \frametitle{General overview}
      \begin{block}{Using the cluster}
\begin{center}
 \includegraphics[width=310pt]{NeSI_img/NeSI_compute_path.png}
\end{center}
  \end{block}
}



\frame[t]
{
  \frametitle{Using the Cluster}
      \begin{block}{Overview}
   \begin{itemize}%[<+-| alert@+>]
	\item The cluster is a shared resource and work must be scheduled.% to run at a later time, known as batch scheduling – no GUI.
	\item Jobs are queued and are executed on the compute nodes.
	\item The login node is not for running jobs, it is only for file management and job submission.
   \end{itemize}
  \end{block}
  \begin{center}
 \includegraphics[width=200pt]{NeSI_img/NeSI_compute_path.png}
\end{center}
}
\frame[t]
{
  \frametitle{Using the Cluster}
      \begin{block}{Compiling and Testing Software}
   \begin{itemize}%[<+-| alert@+>]
	\item In each NeSI facility you will find building/development nodes.
	\item We have the most up to date development tools ready to use.
	\item You can build and test your software and then submit a job.
   \end{itemize}
  \end{block}
  \begin{center}
 \includegraphics[width=200pt]{NeSI_img/NeSI_compute_path.png}
\end{center}
}



\subsection{Getting to the Login Node}
\frame[t]
{
  \frametitle{Using the Cluster}
      \begin{block}{Connection via SSH}
      Each terminal client has its own way of using the Secure Shell (SSH) protocol
        \begin{itemize}
        \item Windows: \href{http://mobaxterm.mobatek.net/}{mobaxterm}
        \item MacOSX: Terminal(Included in the OS), \href{http://www.iterm2.com/}{iTerm2}
        \item Linux: \href{http://konsole.kde.org/}{Konsole}, GnomeTerminal, \href{http://yakuake.kde.org/}{yakuake}
        \end{itemize}
        On Unix based systems you need to do something like:\\ssh \url{jbon007@login.nesi.org.nz}
      \end{block}
}


\frame[t]
{
  \frametitle{Using the Cluster}
  \begin{block}{Each NeSI Supercomputing Center has one or more Login Nodes}
   \begin{itemize}%[<+-| alert@+>]
	\item \textbf{CeR}
	   \begin{itemize}%[<+-| alert@+>]
	    \item {\url{login.uoa.nesi.org.nz}} which is the RHEL linux login node.
	    %\item visual.uoa.nesi.org.nz  which is the Visualization Cluster login node.
       \end{itemize}
	\item \textbf{Bluefern}
	   \begin{itemize}%[<+-| alert@+>]
	    \item \url{kerr.canterbury.ac.nz} which is the AIX unix login node.
	    \item {\url{beatrice.canterbury.ac.nz}} which is the SUSE linux login node.
	    \item {\url{foster.canterbury.ac.nz}} which is the BlueGene/P login node
	    \item {\url{popper.canterbury.ac.nz}} which is the Visualization Cluster login node.
   \end{itemize}
   	\item \textbf{NIWA}
	   \begin{itemize}%[<+-| alert@+>]
	    \item {\url{fitzroy.nesi.org.nz}} which is the AIX unix login node.
      \end{itemize}
   \end{itemize}
  \end{block}
}


\begin{frame}[fragile]
  \frametitle{Using the Cluster}
      \begin{block}{Remote File System Access}
       In order to access the file system (/home) remotely from your machine, we recommend:
        \begin{itemize}
        \item \textbf{Windows} (mobaxterm) : \href{http://mobaxterm.mobatek.net/}{mobaxterm}
        \item \textbf{Windows} (SSHFS) : \url{http://code.google.com/p/win-sshfs/}
        \item \textbf{MacOSX} (SSHFS) : \url{http://code.google.com/p/macfuse/}
        \item \textbf{Linux} (SSHFS) : \url{http://fuse.sourceforge.net/sshfs.html}
        \item \textbf{KDE} (Konqueror) : type fish://user@host:port
        \item \textbf{Gnome} (Nautilus) : type sftp://user@host:port
      \end{itemize}
      \end{block}
\end{frame}

%\begin{frame}[fragile]
%  \frametitle{Using the Cluster}
%      \begin{block}{Remote File System Transfer with RSYNC (Unix Only)}
%       \textbf{RSYNC} over SSH protocol is the best choice to transfer big data.
%        \begin{itemize}
%        \item Transfer data from your machine to the server:\\ {\small \verb|rsync -avHl  /path/origin/* sshserver:/path/destination/|}
%        \item Transfer data from the server to your machine:\\ {\small \verb|rsync -avHl  sshserver:/path/destination/* /path/origin/|}
%        \end{itemize}
%      \end{block}
%      \begin{block}{Remote File System Transfer with scp/sftp (Unix Only)}
%       \textbf{SCP} and \textbf{SFTP} are the most popular software to transfer data across SSH protocol.
%        \begin{itemize}
%        \item {\small \verb|scp -pr sshserver:/path/origin/* path/destination/|}
%        \item {\small \verb|sftp sshserver:/path/origin/* path/destination/|}
%        \end{itemize}
%      \end{block}      
%\end{frame}


\subsection{Data}
\frame[t]
{
  \frametitle{Using the Cluster}
      \begin{block}{Data}
   \begin{itemize}%[<+-| alert@+>]
	\item Upload input data to the login node for use on the cluster.
	\item Download results from the login node to your local drive. 
	\item The home directory has a rather small quota, project directories can be larger.
	\item For long term storage and back-up, ask your IT department.
	\item Things do go wrong, make sure to have a back-up.
	\item Files on the login node are shared across the build and compute nodes
   \end{itemize}
%   \begin{center}
%   \includegraphics[width=125pt]{NeSI_img/kami23-doubtux.png}
%   \end{center}
  \end{block}
}

\section{Submitting a Job}
\subsection{Documentation}
\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Documentation}
   \begin{itemize}%[<+-| alert@+>]
	\item Center specific documentation:
	\begin{itemize}
	\item Bluefern : \url{http://wiki.canterbury.ac.nz/display/BlueFern}
	\item NIWA : \url{http://teamwork.niwa.co.nz/display/HPCF/NIWA+HPCF+User+Documentation}
	\item CeR : \url{http://wiki.auckland.ac.nz/display/CER/}
	\end{itemize}
	\item Examples for submitting jobs are on our Wiki page 
	\item See the ''Getting Started section''
	\item Take a look to the Quick Reference Guide. \url{http://goo.gl/ytbRWy}
	\item You will also find links to available software on the cluster
   \end{itemize}
  \end{block}
}

\subsection{Basic Job Properties}
\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Basic Job Properties}
   \begin{itemize}%[<+-| alert@+>]
	\item \textbf{Name} So you can identify the output later.
	%\item \textbf{Command} What command to execute on the cluster e.g "echo hello"
	\item \textbf{Walltime} How long the job can run for. The job will be cancelled if the walltime is exceeded. 
	\item \textbf{Memory} How much memory to use? Job will die if memory is exceeded.
	\item \textbf{CPU cores} How many to use? Your program may try to use more than you request e.g.\ MATLAB.
	%\item \textbf{Files} You need to specify where additional files can be found and change references in your scripts
	\item \textbf{Account, Project or Group information} Especially important for access to licensed software and funded research allocations
	\item \textbf{Emails} Notification of job starting, also scheduler errors.
   \end{itemize}
  \end{block}
}




\subsection{Outputs}
\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Outputs}
   \begin{center}
   \includegraphics[width=200pt]{NeSI_img/console.png}\\
      Jobs have no interactive interface, but command line output and can write to files. Graphical tools are, however, available on the login and build/development nodes.
   \end{center}      
  \end{block}
}


\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Outputs}
   \begin{itemize}%[<+-| alert@+>]
	\item Information output while the job runs is written to a text file.
	\item Standard output goes to stdout, standard error goes to stderr.
	\item These should have unique names for a given job directory (see job Name)
	\item If your application writes to other files e.g.\ output data, that stays the same
	\item When your job fails, first look at stdout and stderr for clues
   \end{itemize}
  \end{block}
}


\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Environment Modules}
   \begin{itemize}%[<+-| alert@+>]
	\item Modules are a convenient way to provide access to applications on the cluster
	\item They prepare the environment you need to run the application
	\item Commands
        \begin{itemize}
        \item  \textbf{module avail} - lists available modules
        \item  \textbf{module show module\_name} - displays full information about the module with name \textit{module\_name}.
        \item  \textbf{module load module\_name} - loads the module with name \textit{module\_name} and its dependencies. 
        \item  \textbf{module unload module\_name } - unload  the module with name \textit{module\_name} and its dependencies. 
        \item  \textbf{module list} - list all modules currently loaded.
        \end{itemize}
	\item Grisu loads a module when you select an application
   \end{itemize}
  \end{block}
}


\subsection{SLURM}
\frame[t]
{
  \frametitle{Submitting a Job}
      \begin{block}{Quick introduction Slurm}
   \begin{itemize}%[<+-| alert@+>]
	\item You need to access the login node and work from a terminal.
	\item Requires basic knowledge of the Linux command line:
   \begin{itemize}%[<+-| alert@+>]
	\item How to navigate file system and edit files.
	\item Shell scripting is very useful for automation.
	\item Tutorials available online at Software Carpentry – computing basics aimed at researchers.
   \end{itemize}
   \end{itemize}
  \end{block}
  
}



\begin{frame}[fragile,shrink]
  \frametitle{Submitting a job with SLURM: example job file}
\begin{block}{Job Description Example : Serial}
\begin{scriptsize}
\begin{verbatim}
#!/bin/bash
#SBATCH -J Serial_JOB
#SBATCH -A uoa99999         # Project Account
#SBATCH --time=01:00:00     # Walltime
#SBATCH --mem-per-cpu=4096  # memory/core (in MB)

srun cat ~/inputfile.txt
\end{verbatim}
\end{scriptsize}
  \end{block}
{\tiny Also see \url{https://wiki.auckland.ac.nz/display/CER/Slurm+User+Guide}}
\end{frame}


\begin{frame}[fragile,shrink]
  \frametitle{Submitting a job with Slurm: example MPI job file}
     \begin{block}{SLURM job Description Example : MPI}
\begin{scriptsize}
\begin{verbatim}
#!/bin/bash
#SBATCH -J MPI_JOB
#SBATCH -A uoa99999         # Project Account
#SBATCH --time=01:00:00     # Walltime
#SBATCH --ntasks=2          # number of tasks
#SBATCH --mem-per-cpu=4096 # memory/core (in MB)

module load myModule
srun mpi_binary
\end{verbatim}
\end{scriptsize}
  \end{block}
  
{\tiny Also see \url{https://wiki.auckland.ac.nz/display/CER/Slurm+User+Guide}}
\end{frame}


\begin{frame}[fragile]

  \frametitle{Submitting a Job with Slurm: Send the job to the queue}
   \begin{block}{Slurm}
     \begin{itemize}%[<+-| alert@+>]
	\item To submit a job:\\ \begin{verbatim} sbatch myJob.sl \end{verbatim}
	\item To monitor your jobs:\\ \begin{verbatim} squeue –u <myUserId>\end{verbatim}
	\item To cancel:\\ \begin{verbatim} scancel <jobId>\end{verbatim}
     \end{itemize}
  \end{block}
\end{frame}


\section{Additional remarks}

\subsection{Notes for Windows Users}

\frame[t]
{
  \frametitle{Notes for Windows Users}
      \begin{block}{}
   \begin{itemize}%[<+-| alert@+>]
	\item Be careful of Windows end of line (EOL) characters, sometimes Linux will not handle them correctly.
	\item MobaXterm has a build in text file editor. 
	\item Notepad++ lets you convert between Windows and Unix style line endings.
	\item Even though you can avoid using the Linux command line, having a basic understanding will help you debug your jobs.
   \end{itemize}
  \end{block}
}




\subsection{Software}
\frame[t]
{
  \frametitle{Software}
      \begin{block}{}
   \begin{itemize}%[<+-| alert@+>]
	\item We have many specialized software packages.
	\item Best way to see what we have is by checking the wiki. %running module avail on the login node
	\item The Wiki also has a software section.
	\item We can install software that you need:
   \begin{itemize}%[<+-| alert@+>]
	\item Linux version of the software.
	\item Command line mode without user interaction.
	\item Interaction possible for small tests on the build nodes. 
	\item We don't provide licenses.
	\item You can install software in your home directory if it is really esoteric.
   \end{itemize}
   \end{itemize}
  \end{block}
}

\subsection{Best practices and advice}

\frame[t]
{
  \frametitle{Best practices and advice}
   \begin{block}{}
   \begin{itemize}%[<+-| alert@+>]
	\item Share with us a short test and we will study the scalability of your application.
	\item Try to be accurate  with the wall-time, it will help the scheduler to efficiently schedule the jobs.
	\item Be aware that you are sharing resources with other researchers.
	\item A wrong memory request or a wrong job description setup can potentially affect others.
	\item If we find some case like that, we may be forced to cancel the job with this behavior and inform the owner by email.
   \end{itemize}
  \end{block}
}


%\section{Our Expectations}

\frame[t]
{
  \frametitle{Our Expectations}
      \begin{block}{Our Expectations}
   \begin{itemize}%[<+-| alert@+>]
	\item We have an acceptable use policy that follows the NeSI IT policies
	\item We conduct regular reviews of projects to	:
   \begin{itemize}%[<+-| alert@+>]
	\item see how you are going and if you could use some help
	\item collect any research outputs from your work on our facility
	\item determine how the cluster has helped your research 
	\item look at the potential for feature stories on your work
   \end{itemize}
	\item Please contact us if you have any questions
	\item Please acknowledge us in your publications
%	\item We have a blurb on the Wiki front page
   \end{itemize}
  \end{block}
}


%\frame
%{
%\begin{center}
% \includegraphics[width=200pt]{NeSI_img/kami23-doubtux.png}
%\end{center}
%}

%\section{}
%\frame[t]
%{
%  \frametitle{}
%      \begin{block}{}
%   \begin{itemize}%[<+-| alert@+>]
%	\item 
%	\item 
%	\item 
%	\item 
%   \end{itemize}
%  \end{block}
%}

{
\setbeamertemplate{background canvas}{\includegraphics[height=0.99\paperheight]{NeSI_img/Slide00.png}} 
\begin{frame}[plain]
\begin{center}
{\Huge Questions \& Answers}
\end{center}
\end{frame}
}


\end{document} 
